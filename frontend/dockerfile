# Use Node.js 18 LTS as the base image
FROM node:latest-alpine

# Install global dependencies needed for React Native development
# expo-cli is needed if you're using Expo (recommend for easier setup)
RUN npm install -g @expo/cli @react-native-community/cli

# Set the working directory
WORKDIR /app

# Copy package files first for better Docker layer caching
COPY package*.json ./

# Install all dependencies (including devDependencies for development)
RUN npm ci

# Copy the rest of the application
COPY . .

# Create a non-root user for security
RUN addgroup -g 1001 -S nodejs
RUN adduser -S reactnative -u 1001

# Give the user ownership of the app directory
RUN chown -R reactnative:nodejs /app
USER reactnative

# Expose ports for Metro bundler and Expo development server
EXPOSE 8081 19000 19001 19002

# Start the Metro bundler
# This assumes you have a "start" script in package.json
# For Expo: "expo start"
# For React Native CLI: "npx react-native start"
CMD ["npm", "start"]